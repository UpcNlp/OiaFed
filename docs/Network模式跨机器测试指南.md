# Networkæ¨¡å¼è·¨æœºå™¨æµ‹è¯•æŒ‡å—

## ç›®å½•

- [æ¦‚è¿°](#æ¦‚è¿°)
- [ç¯å¢ƒè¦æ±‚](#ç¯å¢ƒè¦æ±‚)
- [ç½‘ç»œé…ç½®](#ç½‘ç»œé…ç½®)
- [é…ç½®æ–‡ä»¶è¯´æ˜](#é…ç½®æ–‡ä»¶è¯´æ˜)
- [å¯åŠ¨æ­¥éª¤](#å¯åŠ¨æ­¥éª¤)
- [æµ‹è¯•æµç¨‹](#æµ‹è¯•æµç¨‹)
- [é¢„æœŸç»“æœ](#é¢„æœŸç»“æœ)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
- [é«˜çº§é…ç½®](#é«˜çº§é…ç½®)

---

## æ¦‚è¿°

æœ¬æŒ‡å—ä»‹ç»å¦‚ä½•ä½¿ç”¨ MOE-FedCL æ¡†æ¶è¿›è¡Œè·¨æœºå™¨çš„è”é‚¦å­¦ä¹ è®­ç»ƒã€‚Network æ¨¡å¼æ”¯æŒåœ¨ä¸åŒçš„ç‰©ç†æœºå™¨ä¸Šéƒ¨ç½²æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ï¼Œå®ç°çœŸæ­£çš„åˆ†å¸ƒå¼è”é‚¦å­¦ä¹ ã€‚

### ç‰¹æ€§

- **çœŸå®MNISTè®­ç»ƒ**: ä½¿ç”¨çœŸå®çš„MNISTæ•°æ®é›†å’ŒCNNæ¨¡å‹
- **FedAvgèšåˆ**: å®ç°æ ‡å‡†çš„è”é‚¦å¹³å‡ç®—æ³•
- **æœåŠ¡å™¨ç«¯è¯„ä¼°**: ä½¿ç”¨ç‹¬ç«‹æµ‹è¯•é›†è¯„ä¼°å…¨å±€æ¨¡å‹
- **è‡ªåŠ¨åœ°å€è½¬æ¢**: å®¢æˆ·ç«¯åœ°å€è‡ªåŠ¨è½¬æ¢ä¸ºå®é™…ç½‘ç»œIP
- **é…ç½®æ–‡ä»¶é©±åŠ¨**: æ‰€æœ‰é…ç½®é€šè¿‡YAMLæ–‡ä»¶ç®¡ç†

---

## ç¯å¢ƒè¦æ±‚

### ç¡¬ä»¶è¦æ±‚

- **æœåŠ¡å™¨**: è‡³å°‘1å°æœºå™¨
- **å®¢æˆ·ç«¯**: è‡³å°‘2å°æœºå™¨ï¼ˆå¯ä»¥ä¸æœåŠ¡å™¨åœ¨åŒä¸€æœºå™¨ä¸Šç”¨äºæµ‹è¯•ï¼‰
- **ç½‘ç»œ**: æ‰€æœ‰æœºå™¨éœ€è¦åœ¨åŒä¸€å±€åŸŸç½‘å†…æˆ–å¯äº’ç›¸è®¿é—®

---

## ç½‘ç»œé…ç½®

### 1. ç¡®å®šç½‘ç»œæ‹“æ‰‘

å‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹æœºå™¨é…ç½®ï¼š

```
æœåŠ¡å™¨: 192.168.31.68 (ç«¯å£ 8000)
å®¢æˆ·ç«¯1: 192.168.31.100
å®¢æˆ·ç«¯2: 192.168.31.101
```

### 2. é˜²ç«å¢™é…ç½®

ç¡®ä¿æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯çš„ç«¯å£å¯ä»¥äº’ç›¸è®¿é—®ï¼š

**æœåŠ¡å™¨ç«¯å£**:
- HTTP: 8000
- WebSocket: 9501

**å®¢æˆ·ç«¯ç«¯å£**:
- HTTP: éšæœºåˆ†é…ï¼ˆç³»ç»Ÿè‡ªåŠ¨ï¼‰
- WebSocket: 9502 (å®¢æˆ·ç«¯1), 9503 (å®¢æˆ·ç«¯2)

**Linuxé˜²ç«å¢™é…ç½®**:
```bash
# æœåŠ¡å™¨
sudo firewall-cmd --add-port=8000/tcp --permanent
sudo firewall-cmd --add-port=9501/tcp --permanent
sudo firewall-cmd --reload

# å®¢æˆ·ç«¯
sudo firewall-cmd --add-port=9502/tcp --permanent  # å®¢æˆ·ç«¯1
sudo firewall-cmd --add-port=9503/tcp --permanent  # å®¢æˆ·ç«¯2
sudo firewall-cmd --reload
```

**Windowsé˜²ç«å¢™é…ç½®**:
```powershell
# å…è®¸Pythonç¨‹åºé€šè¿‡é˜²ç«å¢™
New-NetFirewallRule -DisplayName "MOE-FedCL Server" -Direction Inbound -Protocol TCP -LocalPort 8000,9501 -Action Allow
```

### 3. æµ‹è¯•ç½‘ç»œè¿é€šæ€§

```bash
# ä»å®¢æˆ·ç«¯æµ‹è¯•æœåŠ¡å™¨è¿æ¥
ping 192.168.31.68
telnet 192.168.31.68 8000
```

---

## é…ç½®æ–‡ä»¶è¯´æ˜

### æœåŠ¡å™¨é…ç½® (server.yaml)

ä½ç½®: `examples/configs/network_demo/server.yaml`

```yaml
# èŠ‚ç‚¹åŸºæœ¬ä¿¡æ¯
role: server
mode: network
node_id: network_server_main

# ä¼ è¾“å±‚é…ç½®
transport:
  type: websocket
  host: "0.0.0.0"  # ç›‘å¬æ‰€æœ‰ç½‘ç»œæ¥å£
  port: 8000
  websocket_port: 9501
  timeout: 60.0
  retry_attempts: 5

# é€šä¿¡å±‚é…ç½®
communication:
  heartbeat_interval: 30.0
  heartbeat_timeout: 90.0
  rpc_timeout: 180.0

# è®­ç»ƒé…ç½®
training:
  trainer:
    name: FedAvgMNIST
    params:
      algorithm: fedavg
      local_epochs: 1
      learning_rate: 0.01
      batch_size: 32
      max_rounds: 10
      min_clients: 2
      client_selection_ratio: 1.0
```

**å…³é”®é…ç½®é¡¹è¯´æ˜**:
- `host: "0.0.0.0"`: ç›‘å¬æ‰€æœ‰ç½‘ç»œæ¥å£ï¼Œå…è®¸å¤–éƒ¨è¿æ¥
- `max_rounds: 10`: æœ€å¤§è®­ç»ƒè½®æ•°
- `min_clients: 2`: æœ€å°‘éœ€è¦2ä¸ªå®¢æˆ·ç«¯æ‰èƒ½å¼€å§‹è®­ç»ƒ
- `client_selection_ratio: 1.0`: é€‰æ‹©æ‰€æœ‰å¯ç”¨å®¢æˆ·ç«¯å‚ä¸è®­ç»ƒ

### å®¢æˆ·ç«¯é…ç½® (client1.yaml)

ä½ç½®: `examples/configs/network_demo/client1.yaml`

```yaml
# èŠ‚ç‚¹åŸºæœ¬ä¿¡æ¯
role: client
mode: network
node_id: network_client_1

# ä¼ è¾“å±‚é…ç½®
transport:
  type: websocket
  host: "0.0.0.0"  # ç›‘å¬æ‰€æœ‰æ¥å£ï¼ˆæœåŠ¡å™¨éœ€è¦å›è°ƒï¼‰
  port: 0  # 0è¡¨ç¤ºéšæœºç«¯å£
  websocket_port: 9502
  timeout: 60.0
  retry_attempts: 5

  # æœåŠ¡å™¨åœ°å€ï¼ˆé‡è¦ï¼šéœ€è¦ä¿®æ”¹ä¸ºå®é™…æœåŠ¡å™¨IPï¼‰
  server:
    host: "192.168.31.68"  # æœåŠ¡å™¨IPåœ°å€
    port: 8000

# é€šä¿¡å±‚é…ç½®
communication:
  heartbeat_interval: 30.0
  heartbeat_timeout: 90.0
  rpc_timeout: 180.0

# å­¦ä¹ å™¨é…ç½®
training:
  learner:
    name: MNISTLearner
    params:
      local_epochs: 1
      learning_rate: 0.01
      batch_size: 32
```

**å…³é”®é…ç½®é¡¹è¯´æ˜**:
- `server.host`: **å¿…é¡»ä¿®æ”¹ä¸ºå®é™…çš„æœåŠ¡å™¨IPåœ°å€**
- `port: 0`: å®¢æˆ·ç«¯ä½¿ç”¨éšæœºç«¯å£
- `websocket_port`: æ¯ä¸ªå®¢æˆ·ç«¯ä½¿ç”¨ä¸åŒçš„WebSocketç«¯å£

### å®¢æˆ·ç«¯2é…ç½® (client2.yaml)

ä¸client1.yamlç±»ä¼¼ï¼Œåªéœ€ä¿®æ”¹ï¼š
```yaml
node_id: network_client_2
websocket_port: 9503  # ä¸client1ä¸åŒ
```

---

## å¯åŠ¨æ­¥éª¤

### æ­¥éª¤1: ä¿®æ”¹é…ç½®æ–‡ä»¶

1. **ç¡®å®šæœåŠ¡å™¨IPåœ°å€**:
   ```bash
   # Linux/Mac
   ifconfig | grep "inet "

   # Windows
   ipconfig
   ```

2. **ä¿®æ”¹å®¢æˆ·ç«¯é…ç½®**:

   ç¼–è¾‘ `examples/configs/network_demo/client1.yaml`:
   ```yaml
   server:
     host: "YOUR_SERVER_IP"  # æ›¿æ¢ä¸ºå®é™…çš„æœåŠ¡å™¨IP
     port: 8000
   ```

   å¯¹ `client2.yaml` åšç›¸åŒä¿®æ”¹ã€‚

3. **ï¼ˆå¯é€‰ï¼‰ä¿®æ”¹æœåŠ¡å™¨é…ç½®**:

   å¦‚æœæœåŠ¡å™¨ä¸æƒ³ç›‘å¬æ‰€æœ‰æ¥å£ï¼Œå¯ä»¥æŒ‡å®šå…·ä½“IPï¼š
   ```yaml
   transport:
     host: "192.168.31.68"  # æœåŠ¡å™¨çš„å®é™…IP
   ```

### æ­¥éª¤2: å¯åŠ¨æœåŠ¡å™¨

åœ¨æœåŠ¡å™¨æœºå™¨ä¸Šæ‰§è¡Œï¼š

```bash
cd MOE-FedCL
python examples/network_server.py
```

**é¢„æœŸè¾“å‡º**:
```
======================================================================
Networkæ¨¡å¼ - MNISTè”é‚¦å­¦ä¹ æœåŠ¡å™¨ï¼ˆçœŸå®è®­ç»ƒç‰ˆæœ¬ï¼‰
======================================================================

ä»é…ç½®æ–‡ä»¶åŠ è½½: examples/configs/network_demo/server.yaml
æœåŠ¡å™¨ID: network_server_main
ç›‘å¬åœ°å€: 0.0.0.0:8000

åˆå§‹åŒ–æœåŠ¡å™¨...
å¯åŠ¨æœåŠ¡å™¨...

[OK] æœåŠ¡å™¨å·²å¯åŠ¨

ç­‰å¾…å®¢æˆ·ç«¯è¿æ¥ï¼ˆ30ç§’ï¼‰...
```

### æ­¥éª¤3: å¯åŠ¨å®¢æˆ·ç«¯

#### å®¢æˆ·ç«¯1

åœ¨ç¬¬ä¸€å°å®¢æˆ·ç«¯æœºå™¨ä¸Šæ‰§è¡Œï¼š

```bash
cd MOE-FedCL
python examples/network_client.py
```

é»˜è®¤ä½¿ç”¨ `client1.yaml` é…ç½®ã€‚

**å¦‚æœè¦ä½¿ç”¨client2é…ç½®**ï¼Œéœ€è¦ä¿®æ”¹ `network_client.py` ç¬¬469è¡Œï¼š
```python
config_file = "examples/configs/network_demo/client2.yaml"
```

#### å®¢æˆ·ç«¯2

åœ¨ç¬¬äºŒå°å®¢æˆ·ç«¯æœºå™¨ä¸Šæ‰§è¡Œç›¸åŒå‘½ä»¤ï¼Œä½†éœ€è¦ä½¿ç”¨ä¸åŒçš„é…ç½®æ–‡ä»¶ã€‚

**é¢„æœŸè¾“å‡º**:
```
======================================================================
Networkæ¨¡å¼ - MNISTè”é‚¦å­¦ä¹ å®¢æˆ·ç«¯ï¼ˆçœŸå®è®­ç»ƒç‰ˆæœ¬ï¼‰
======================================================================

ä»é…ç½®æ–‡ä»¶åŠ è½½: examples/configs/network_demo/client1.yaml
å®¢æˆ·ç«¯ID: network_client_1
æœåŠ¡å™¨åœ°å€: 192.168.31.68:8000

åˆå§‹åŒ–å®¢æˆ·ç«¯...
å¯åŠ¨å®¢æˆ·ç«¯...

[OK] å®¢æˆ·ç«¯å·²å¯åŠ¨å¹¶ç­‰å¾…æœåŠ¡å™¨è®­ç»ƒæŒ‡ä»¤

ç­‰å¾…æ³¨å†Œåˆ°æœåŠ¡å™¨...
   æ³¨å†ŒçŠ¶æ€: å·²æ³¨å†Œ

[INFO] å®¢æˆ·ç«¯æ­£åœ¨è¿è¡Œ...
(æŒ‰ Ctrl+C åœæ­¢)
```

---

## æµ‹è¯•æµç¨‹

### å®Œæ•´æµ‹è¯•æµç¨‹

1. **å¯åŠ¨æœåŠ¡å™¨** â†’ ç­‰å¾…å®¢æˆ·ç«¯è¿æ¥
2. **å¯åŠ¨å®¢æˆ·ç«¯1** â†’ æ³¨å†Œåˆ°æœåŠ¡å™¨
3. **å¯åŠ¨å®¢æˆ·ç«¯2** â†’ æ³¨å†Œåˆ°æœåŠ¡å™¨
4. **æœåŠ¡å™¨å¼€å§‹è®­ç»ƒ** â†’ è‡ªåŠ¨æ‰§è¡Œå¤šè½®è®­ç»ƒ
5. **æŸ¥çœ‹è®­ç»ƒç»“æœ** â†’ è¯„ä¼°æ¨¡å‹æ€§èƒ½
6. **åœæ­¢æ‰€æœ‰èŠ‚ç‚¹** â†’ Ctrl+C

### è®­ç»ƒè¿‡ç¨‹ç›‘æ§

æœåŠ¡å™¨ç«¯ä¼šæ˜¾ç¤ºï¼š

```
======================================================================
å¼€å§‹è”é‚¦å­¦ä¹ è®­ç»ƒ (æœ€å¤š 10 è½®)
======================================================================

--- Round 1 ---
  Selected clients: ['network_client_1', 'network_client_2']
  [network_client_1] Starting training...
  [network_client_2] Starting training...
  [network_client_1] Training succeeded: Loss=0.5234, Acc=0.8456
  [network_client_2] Training succeeded: Loss=0.4987, Acc=0.8612
  Round 1 summary: Loss=0.5111, Acc=0.8534
  Aggregating models using FedAvg...
  åœ¨æœåŠ¡å™¨ç«¯è¯„ä¼°å…¨å±€æ¨¡å‹...
  æœåŠ¡å™¨ç«¯è¯„ä¼°ç»“æœ: Acc=0.8523, Loss=0.5023, Samples=10000

Round 1 completed in 15.23s
  Metrics: accuracy=0.8534, loss=0.5111

--- Round 2 ---
...
```

å®¢æˆ·ç«¯ä¼šæ˜¾ç¤ºè®­ç»ƒæ—¥å¿—ï¼š

```
[network_client_1] Round 1, Training 1 epochs...
    [network_client_1] Epoch 1: Loss=0.5234, Acc=0.8456
  [network_client_1] Round 1 completed: Loss=0.5234, Acc=0.8456
```

---

## é¢„æœŸç»“æœ

### è®­ç»ƒæŒ‡æ ‡

ç»è¿‡10è½®è®­ç»ƒåï¼Œé¢„æœŸç»“æœï¼š

| æŒ‡æ ‡ | é¢„æœŸèŒƒå›´ | è¯´æ˜ |
|------|---------|------|
| æœ€ç»ˆå‡†ç¡®ç‡ | 0.95 - 0.98 | åœ¨æµ‹è¯•é›†ä¸Šçš„å‡†ç¡®ç‡ |
| æœ€ç»ˆæŸå¤± | 0.05 - 0.15 | äº¤å‰ç†µæŸå¤± |
| æ¯è½®æ—¶é—´ | 10 - 30ç§’ | å–å†³äºç½‘ç»œå’Œæ•°æ®é‡ |
| æ€»è®­ç»ƒæ—¶é—´ | 2 - 5åˆ†é’Ÿ | 10è½®è®­ç»ƒ |

### æå‰åœæ­¢

å¦‚æœè®­ç»ƒå‡†ç¡®ç‡è¾¾åˆ° **0.98**ï¼Œè®­ç»ƒä¼šè‡ªåŠ¨æå‰åœæ­¢ï¼š

```
[INFO] è®­ç»ƒæå‰åœæ­¢ï¼ˆè¾¾åˆ°åœæ­¢æ¡ä»¶ï¼‰

======================================================================
è®­ç»ƒå®Œæˆ!
======================================================================
å®é™…å®Œæˆè½®æ•°: 7/10
åœæ­¢åŸå› : converged

æœ€ç»ˆå…¨å±€æ¨¡å‹è¯„ä¼°:
  å‡†ç¡®ç‡: 0.9815
  æŸå¤±: 0.0623
  æ€»æ—¶é—´: 189.45ç§’
```

### æˆåŠŸæ ‡å¿—

è®­ç»ƒæˆåŠŸçš„æ ‡å¿—ï¼š
- âœ… æ‰€æœ‰å®¢æˆ·ç«¯æˆåŠŸæ³¨å†Œ
- âœ… æ¯è½®è®­ç»ƒéƒ½æœ‰å®¢æˆ·ç«¯å‚ä¸
- âœ… æ¨¡å‹å‡†ç¡®ç‡é€æ­¥æå‡
- âœ… æŸå¤±é€æ­¥ä¸‹é™
- âœ… æ— å®¢æˆ·ç«¯æ–­å¼€æˆ–è¶…æ—¶é”™è¯¯

---

## å¸¸è§é—®é¢˜

### 1. å®¢æˆ·ç«¯æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨

**ç—‡çŠ¶**:
```
Register to server failed: Cannot connect to host 192.168.31.68:8000
```

**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥æœåŠ¡å™¨IPåœ°å€æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å·²å¯åŠ¨
- æ£€æŸ¥é˜²ç«å¢™é…ç½®
- ä½¿ç”¨ `ping` å’Œ `telnet` æµ‹è¯•è¿é€šæ€§

### 2. å®¢æˆ·ç«¯æ³¨å†Œå¤±è´¥

**ç—‡çŠ¶**:
```
Registration attempt 1 failed: Failed to register with server
```

**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥å®¢æˆ·ç«¯é…ç½®ä¸­çš„ `server.host` å’Œ `server.port`
- ç¡®ä¿æœåŠ¡å™¨å·²å®Œå…¨å¯åŠ¨
- æ£€æŸ¥ç½‘ç»œå»¶è¿Ÿï¼Œå¯èƒ½éœ€è¦å¢åŠ è¶…æ—¶æ—¶é—´

### 3. è®­ç»ƒæ— æ³•å¼€å§‹

**ç—‡çŠ¶**:
```
[Warning] æœŸæœ›è‡³å°‘2ä¸ªå®¢æˆ·ç«¯ï¼Œä½†åªæœ‰ 1 ä¸ª
```

**è§£å†³æ–¹æ¡ˆ**:
- ç¡®ä¿å¯åŠ¨äº†è¶³å¤Ÿæ•°é‡çš„å®¢æˆ·ç«¯ï¼ˆè‡³å°‘2ä¸ªï¼‰
- æ£€æŸ¥å®¢æˆ·ç«¯æ˜¯å¦æˆåŠŸæ³¨å†Œï¼ˆæŸ¥çœ‹å®¢æˆ·ç«¯æ—¥å¿—ï¼‰
- ç­‰å¾…æ›´é•¿æ—¶é—´è®©å®¢æˆ·ç«¯è¿æ¥

### 4. ç«¯å£å†²çª

**ç—‡çŠ¶**:
```
OSError: [Errno 98] Address already in use
```

**è§£å†³æ–¹æ¡ˆ**:
- ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„ç«¯å£å·
- æˆ–è€…åœæ­¢å ç”¨ç«¯å£çš„è¿›ç¨‹

### 5. åœ°å€è½¬æ¢é”™è¯¯

**ç—‡çŠ¶**:
å®¢æˆ·ç«¯åœ°å€æ˜¾ç¤ºä¸º `127.0.0.1` è€Œä¸æ˜¯å®é™…ç½‘ç»œIP

**è§£å†³æ–¹æ¡ˆ**:
- è¿™æ˜¯ä¸€ä¸ªå·²çŸ¥é—®é¢˜ï¼Œåœ¨ `fedcl/learner/stub.py` ä¸­çš„åœ°å€è½¬æ¢é€»è¾‘
- ç¡®ä¿å®¢æˆ·ç«¯é…ç½®ä½¿ç”¨ `host: "0.0.0.0"`
- ç³»ç»Ÿä¼šè‡ªåŠ¨è·å–ç½‘å¡IPåœ°å€

### 6. MNISTæ•°æ®ä¸‹è½½å¤±è´¥

**ç—‡çŠ¶**:
```
HTTPError: HTTP Error 403: Forbidden
```

**è§£å†³æ–¹æ¡ˆ**:
- æ‰‹åŠ¨ä¸‹è½½MNISTæ•°æ®é›†åˆ° `examples/data` ç›®å½•
- æˆ–ä½¿ç”¨å›½å†…é•œåƒç«™ç‚¹
- æˆ–é…ç½®ä»£ç†

---

## é«˜çº§é…ç½®

### 1. è°ƒæ•´è®­ç»ƒå‚æ•°

ä¿®æ”¹ `server.yaml` ä¸­çš„è®­ç»ƒå‚æ•°ï¼š

```yaml
training:
  trainer:
    params:
      max_rounds: 20        # å¢åŠ è®­ç»ƒè½®æ•°
      min_clients: 3        # éœ€è¦æ›´å¤šå®¢æˆ·ç«¯
      local_epochs: 2       # æ¯è½®æœ¬åœ°è®­ç»ƒ2ä¸ªepoch
      learning_rate: 0.001  # é™ä½å­¦ä¹ ç‡
      batch_size: 64        # å¢å¤§batch size
```

### 2. ä¿®æ”¹åœæ­¢æ¡ä»¶

ç¼–è¾‘ `examples/network_server.py` çš„ `should_stop_training` æ–¹æ³•ï¼š

```python
def should_stop_training(self, round_num: int, round_result: Dict[str, Any]) -> bool:
    """åˆ¤æ–­æ˜¯å¦åº”è¯¥åœæ­¢è®­ç»ƒ"""
    round_metrics = round_result.get("round_metrics", {})
    avg_accuracy = round_metrics.get("avg_accuracy", 0.0)

    # ä¿®æ”¹åœæ­¢æ¡ä»¶
    if avg_accuracy >= 0.95:  # é™ä½åˆ°0.95
        self.logger.info(f"High accuracy achieved: {avg_accuracy:.4f}")
        return True

    return False
```

### 3. å®¢æˆ·ç«¯æ•°æ®åˆ’åˆ†

ä¿®æ”¹ `examples/network_client.py` çš„ `_load_dataset` æ–¹æ³•æ¥æ”¹å˜æ•°æ®åˆ’åˆ†ç­–ç•¥ï¼š

```python
def _load_dataset(self):
    """åŠ è½½æ•°æ®é›†"""
    mnist_dataset_cls = registry.get_dataset('MNIST')
    mnist_dataset = mnist_dataset_cls(root='examples/data', train=True, download=True)
    base_dataset = mnist_dataset.dataset

    # è‡ªå®šä¹‰æ•°æ®åˆ’åˆ†é€»è¾‘
    # ä¾‹å¦‚ï¼šéIIDåˆ’åˆ†ã€æŒ‰æ ‡ç­¾åˆ’åˆ†ç­‰
    client_idx = int(self.client_id.split('_')[-1])
    # ... å®ç°è‡ªå®šä¹‰åˆ’åˆ†ç­–ç•¥

    return train_dataset
```

### 4. ä½¿ç”¨GPUåŠ é€Ÿ

ç¡®ä¿PyTorchèƒ½å¤Ÿè®¿é—®GPUï¼š

```python
# åœ¨ MNISTLearner ä¸­
self.device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
print(f"Using device: {self.device}")
```

### 5. æ—¥å¿—çº§åˆ«è°ƒæ•´

åœ¨è„šæœ¬å¼€å¤´è®¾ç½®æ—¥å¿—çº§åˆ«ï¼š

```python
import logging
logging.getLogger('fedcl').setLevel(logging.DEBUG)  # è¯¦ç»†æ—¥å¿—
# æˆ–
logging.getLogger('fedcl').setLevel(logging.INFO)   # æ­£å¸¸æ—¥å¿—
```

---

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. ç½‘ç»œä¼˜åŒ–

- ä½¿ç”¨æœ‰çº¿ç½‘ç»œè€ŒéWiFi
- å‡å°‘ç½‘ç»œè·³æ•°
- å¢åŠ å¸¦å®½

### 2. è®­ç»ƒä¼˜åŒ–

- å¢å¤§batch sizeï¼ˆåœ¨GPUå†…å­˜å…è®¸çš„æƒ…å†µä¸‹ï¼‰
- ä½¿ç”¨æ›´å¿«çš„ä¼˜åŒ–å™¨ï¼ˆå¦‚ AdamWï¼‰
- å‡å°‘æ¨¡å‹å¤§å°

### 3. ç³»ç»Ÿä¼˜åŒ–

- ä½¿ç”¨SSDè€ŒéHDD
- å¢åŠ ç³»ç»Ÿå†…å­˜
- ä½¿ç”¨GPUåŠ é€Ÿ

---

## æ•…éšœæ’é™¤æ£€æŸ¥æ¸…å•

å¯åŠ¨å‰æ£€æŸ¥ï¼š
- [ ] æ‰€æœ‰æœºå™¨ç½‘ç»œäº’é€š
- [ ] é˜²ç«å¢™é…ç½®æ­£ç¡®
- [ ] Pythonç¯å¢ƒå’Œä¾èµ–å®‰è£…å®Œæˆ
- [ ] é…ç½®æ–‡ä»¶ä¸­çš„IPåœ°å€æ­£ç¡®
- [ ] ç«¯å£æ²¡æœ‰å†²çª

è¿è¡Œæ—¶æ£€æŸ¥ï¼š
- [ ] æœåŠ¡å™¨æˆåŠŸå¯åŠ¨
- [ ] å®¢æˆ·ç«¯æˆåŠŸæ³¨å†Œ
- [ ] æ—¥å¿—æ²¡æœ‰é”™è¯¯ä¿¡æ¯
- [ ] è®­ç»ƒæ­£å¸¸è¿›è¡Œ
- [ ] æ¨¡å‹å‡†ç¡®ç‡æå‡

---

## å‚è€ƒèµ„æ–™

- [MOE-FedCL é¡¹ç›®æ–‡æ¡£](../README.md)
- [é…ç½®æ–‡ä»¶ç¤ºä¾‹](../examples/configs/network_demo/)
- [APIæ–‡æ¡£](../docs/API.md)
- [å¸¸è§é—®é¢˜FAQ](../docs/FAQ.md)

---

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹é¡¹ç›®Issue: <repository_issues_url>
2. æäº¤æ–°çš„Issueæè¿°é—®é¢˜
3. å‚è€ƒé¡¹ç›®æ–‡æ¡£è·å–æ›´å¤šä¿¡æ¯

---

**ç¥æµ‹è¯•é¡ºåˆ©ï¼ğŸ‰**
