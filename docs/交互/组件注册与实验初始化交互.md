```mermaid
sequenceDiagram
    participant User as 用户/开发者
    participant QA as QuickAPI
    participant FE as FedCLExperiment
    participant CM as ConfigManager
    participant CR as ComponentRegistry
    participant CC as ComponentComposer
    participant EC as ExecutionContext
    participant EE as ExperimentEngine
    participant DM as DatasetManager
    participant CommMgr as CommunicationManager
    
    Note over User,CommMgr: 实验启动前的组件注册（开发时）
    
    User->>CR: @register_learner("L2P")
    CR->>CR: store_component_metadata("L2P", L2PLearner)
    
    User->>CR: @register_aggregator("FedAvg")
    CR->>CR: store_component_metadata("FedAvg", FedAvgAggregator)
    
    User->>CR: @register_hook("before_task")
    CR->>CR: store_hook_metadata("before_task", MetricsHook)
    
    Note over User,CommMgr: 实验运行时的初始化流程
    
    User->>QA: quick_experiment(method="L2P", dataset="CIFAR10")
    QA->>FE: __init__(config, working_dir, seed)
    
    Note over FE,CM: 配置加载与验证
    FE->>CM: load_config(config_path)
    CM->>CM: validate_config(config)
    CM-->>FE: validated_config
    
    Note over FE,EE: 实验引擎启动
    FE->>EE: start_experiment(config)
    
    Note over EE,CR: 组件发现阶段
    EE->>CR: get_component("L2P")
    CR-->>EE: L2PLearner_factory
    
    EE->>CR: get_component("FedAvg") 
    CR-->>EE: FedAvgAggregator_factory
    
    EE->>CR: get_hooks("before_task")
    CR-->>EE: [MetricsHook, CheckpointHook]
    
    Note over EE,CC: 组件组装阶段
    EE->>CC: compose_experiment(config, context)
    
    Note over CC,EC: 执行上下文初始化
    CC->>EC: initialize_context(config)
    EC->>EC: setup_global_state()
    EC->>EC: setup_local_state()
    
    Note over CC,DM: 数据管理初始化
    CC->>DM: load_dataset(dataset_config)
    DM->>DM: create_task_sequence()
    DM-->>CC: task_sequence
    
    Note over CC,CommMgr: 通信管理初始化
    CC->>CommMgr: initialize_communication(network_config)
    CommMgr->>CommMgr: setup_message_protocol()
    CommMgr->>CommMgr: setup_network_interface()
    CommMgr-->>CC: communication_ready
    
    Note over CC,EC: 组件实例化
    loop 为每个注册的组件
        CC->>CR: create_instance(component_name, config)
        CR->>CR: instantiate_component(factory, config)
        CR-->>CC: component_instance
        CC->>EC: register_component(instance)
    end
    
    Note over CC,EE: 依赖注入完成
    CC-->>EE: experiment_components
    
    Note over EE,EC: 生命周期管理启动
    EE->>EC: start_component_lifecycle()
    
    loop 为每个组件
        EC->>EC: component.initialize(context)
        EC->>EC: component.configure(config)  
        EC->>EC: component.start()
    end
    
    EC-->>EE: all_components_ready
    EE-->>FE: experiment_initialized
    FE-->>QA: experiment_ready
    QA-->>User: ExperimentResults (当实验完成时)
    
    Note over User,CommMgr: 实验开始执行...