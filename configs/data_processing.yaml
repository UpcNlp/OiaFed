# configs/data_processing.yaml
# 数据处理配置示例

data_processing:
  # 数据变换配置
  transforms:
    - name: "resize"
      params:
        size: [224, 224]  # 目标尺寸
    - name: "center_crop"
      params:
        size: [224, 224]
    - name: "random_horizontal_flip"
      params:
        p: 0.5
    - name: "normalize"
      params:
        mean: [0.485, 0.456, 0.406]  # ImageNet均值
        std: [0.229, 0.224, 0.225]   # ImageNet标准差
    - name: "to_tensor"
      params: {}

  # 数据增强配置
  augmentation:
    enable: true
    factor: 1.5  # 数据扩展因子
    strategies:
      - "rotation"
      - "color_jitter"
      - "gaussian_noise"
      - "random_erasing"
    
    # 增强参数
    rotation_degrees: 15
    color_jitter_brightness: 0.2
    color_jitter_contrast: 0.2
    noise_std: 0.01

  # 数据标准化配置
  normalization:
    method: "standard"  # standard, min_max, unit_norm
    per_channel: true
    eps: 1e-8

  # 数据验证配置
  validation:
    check_nan: true
    check_range: true
    check_distribution: true
    allow_class_imbalance: false
    max_class_ratio: 10  # 最大类别比例

  # 联邦学习数据分割配置
  federated_split:
    strategy: "iid"  # iid, non_iid
    non_iid_alpha: 0.5  # Dirichlet分布参数
    min_samples_per_client: 10
    balance_clients: true

  # 性能和内存优化
  memory_efficient: true
  max_workers: 4
  batch_processing_threshold: 1000  # 大于此数量时使用批处理
  cache_enabled: true
  max_cache_size: 100  # 最大缓存项数

  # 数据质量控制
  quality_control:
    remove_corrupted: true
    remove_duplicates: false
    outlier_detection: false
    outlier_threshold: 3.0  # 标准差倍数

# 数据集特定配置
datasets:
  cifar10:
    transforms:
      - name: "resize"
        params:
          size: [32, 32]
      - name: "normalize"
        params:
          mean: [0.4914, 0.4822, 0.4465]
          std: [0.2023, 0.1994, 0.2010]
    
    augmentation:
      enable: true
      strategies: ["random_horizontal_flip", "random_crop"]
      
  imagenet:
    transforms:
      - name: "resize"
        params:
          size: [256, 256]
      - name: "center_crop"
        params:
          size: [224, 224]
      - name: "normalize"
        params:
          mean: [0.485, 0.456, 0.406]
          std: [0.229, 0.224, 0.225]
    
    augmentation:
      enable: true
      strategies: ["random_horizontal_flip", "color_jitter", "rotation"]

  mnist:
    transforms:
      - name: "resize"
        params:
          size: [28, 28]
      - name: "normalize"
        params:
          mean: [0.1307]
          std: [0.3081]
    
    augmentation:
      enable: false  # MNIST通常不需要复杂增强
