# 新统一日志系统测试 - Server 配置
# configs/test_logging/server.yaml

role: server
node_id: server_test

# ===== 新统一日志配置 =====
logging:
  # 实验名称
  experiment_name: "test_unified_logging"

  # Layer 1: Runtime Logs (Loguru)
  runtime:
    console_enabled: true    # Server 显示控制台
    console_level: "INFO"
    file_level: "DEBUG"

  # Layer 2: Training Progress (进度条)
  progress:
    enabled: true            # Server 显示进度条
    style: "rich"            # rich 或 tqdm
    refresh_rate: 0.5

  # Layer 3: Experiment Tracking (MLflow)
  tracker:
    enabled: true            # 启用实验追踪
    type: "mlflow"           # mlflow, wandb, tensorboard
    config:
      # MLflow 远程服务器配置（从 .env 读取认证信息）
      tracking_uri: "http://172.19.138.200:5000"

  # 是否收集 Loguru 日志作为 artifacts
  collect_loguru_artifacts: true

# ===== 通信配置 =====
communication:
  mode: memory               # 本地串行/并行模式
  server:
    host: "127.0.0.1"
    port: 8001

# ===== 训练配置 =====
training:
  max_rounds: 3              # 快速测试
  min_clients: 2
  trainer:
    name: "Generic"
    params:
      local_epochs: 1
      learning_rate: 0.01
      batch_size: 64

  # 聚合器配置
  aggregator:
    name: "fedavg"

  # 全局模型配置
  global_model:
    name: "MNIST_CNN"
    params:
      num_classes: 10
